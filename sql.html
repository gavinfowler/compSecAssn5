<!DOCTYPE html>

<html lang="en">
    <head>
        <meta charset="utf-8" />

        <title>Assn5</title>
        <meta name="description" content="Computer Security Assn4" />
        <meta name="author" content="GAMK" />

        <link
            rel="stylesheet"
            href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
            integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
            crossorigin="anonymous"
        />
    </head>

    <body>
        <div
            class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom shadow-sm"
        >
            <h5 class="my-0 mr-md-auto font-weight-normal">
                Computer Security Assignment 6
            </h5>
            <nav class="my-2 my-md-0 mr-md-3">
                <a class="p-2 text-dark" href="phishing.html"
                    >Task 1: Phishing</a
                >
            </nav>
        </div>
        <div class="text-center">
            <h1>Task 2: SQL</h1>
            <div class="w-75 m-auto">
              <div>
                <label for="sqlquery">SQL Query</label>
                <input class="form-control mb-3" id="query" placeholder="Query" />
              </div>
              <div class="pt-5 pb-5">
                <button type="button" class="btn btn-primary btn-lg btn-block" onclick="buttonClicked()">
                  Submit
                </button>
              </div>
              <p>
                Chances of bad intentions:
                <div id="results" class="d-inline-block"></div>/100
              </p>
              <p>
                Reason for score:
                <div id="reason"/>
              </p>
            </div>
        </div>
    </body>
  <script>
    const button = document.getElementById('button')
    const sqlQuery = document.getElementById('query')
    const results = document.getElementById('results')
    const reason = document.getElementById('reason')

    const keyWords = [
      "1=1",
      "--",
      "\"",
      "convert",
      "int",
      "sysobjects",
      "xtype",
      "union",
      ";",
      "shutdown",
      "@",
      "1=0",
      "ascii",
      "substring",
      "waitfor",
      "exec",
      "char",
      "0x",
    ]

    function buttonClicked() {
        let query = sqlQuery.value.toLowerCase()
        let total = 0
        let text = ''
        
        keyWords.forEach(e =>{
            if(query.includes(e)){
                total += 10
                text += `Input contains keyword: ${e}<br>`
            }
        })
        
        let numPairs = Math.floor((total / 10) / 2)
        for (i = 0; i < numPairs; i++) {
          total += 50
        }

        if(total > 99) {
          total = 99
        }
        results.innerHTML = total
        reason.innerHTML = text
    }
  </script>
</html>
